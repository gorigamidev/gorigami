---
// Minimal language switcher with flat CSS icons
---

<div class="lang-switcher">
	<button
		class="lang-btn"
		data-lang="en"
		aria-label="Switch to English"
		onclick="switchLang('en')"
	>
		<span class="lang-icon icon-en"></span>
		<span class="lang-text">EN</span>
	</button>
	<button
		class="lang-btn"
		data-lang="es"
		aria-label="Cambiar a EspaÃ±ol"
		onclick="switchLang('es')"
	>
		<span class="lang-icon icon-es"></span>
		<span class="lang-text">ES</span>
	</button>
</div>

<script is:inline>
	// Global function for language switching
	function switchLang(lang) {
		console.log("[LanguageSwitcher] Switching to:", lang);

		// Save to localStorage (primary persistence mechanism)
		localStorage.setItem("gorigami-lang", lang);

		// Update HTML lang attribute
		document.documentElement.lang = lang;

		// Update active button state immediately
		document.querySelectorAll(".lang-btn").forEach(function (btn) {
			if (btn.getAttribute("data-lang") === lang) {
				btn.classList.add("active");
			} else {
				btn.classList.remove("active");
			}
		});

		// Update all translations on the page (if function is available)
		if (typeof window.updatePageTranslations === "function") {
			window.updatePageTranslations(lang);
			console.log("[LanguageSwitcher] Static translations updated");
		} else {
			console.warn(
				"[LanguageSwitcher] updatePageTranslations not yet available",
			);
		}

		// Update data-driven content (if function is available)
		if (typeof window.updateAllDataTranslations === "function") {
			window.updateAllDataTranslations();
			console.log("[LanguageSwitcher] Data translations updated");
		} else {
			console.warn(
				"[LanguageSwitcher] updateAllDataTranslations not yet available",
			);
		}
	}
</script>

<style>
	.lang-switcher {
		display: flex;
		gap: 0.5rem;
		align-items: center;
	}

	.lang-btn {
		display: flex;
		align-items: center;
		gap: 0.25rem;
		padding: 0.4rem 0.6rem;
		background: transparent;
		border: 1px solid var(--light-gray);
		cursor: pointer;
		transition: all 0.2s ease;
		font-family: var(--body-font);
		font-size: 0.85rem;
		font-weight: 500;
		color: var(--mid-gray);
	}

	.lang-btn:hover {
		border-color: var(--sandy-brown);
		color: var(--midnight-violet);
	}

	.lang-btn.active {
		background: var(--sandy-brown);
		border-color: var(--sandy-brown);
		color: var(--paper-white);
	}

	.lang-icon {
		width: 1rem;
		height: 1rem;
		position: relative;
		display: inline-block;
	}

	/* EN flag - simple stripes */
	.icon-en::before {
		content: "";
		position: absolute;
		width: 100%;
		height: 0.3rem;
		background: currentColor;
		top: 0;
		left: 0;
		opacity: 0.6;
	}

	.icon-en::after {
		content: "";
		position: absolute;
		width: 100%;
		height: 0.3rem;
		background: currentColor;
		bottom: 0;
		left: 0;
		opacity: 0.6;
	}

	/* ES flag - simple stripes */
	.icon-es::before {
		content: "";
		position: absolute;
		width: 100%;
		height: 0.25rem;
		background: currentColor;
		top: 0;
		left: 0;
		opacity: 0.6;
	}

	.icon-es::after {
		content: "";
		position: absolute;
		width: 100%;
		height: 0.5rem;
		background: currentColor;
		top: 50%;
		left: 0;
		transform: translateY(-50%);
		opacity: 0.8;
	}

	.lang-text {
		font-size: 0.75rem;
		letter-spacing: 0.05em;
	}

	@media screen and (max-width: 768px) {
		.lang-btn {
			padding: 0.35rem 0.5rem;
			font-size: 0.8rem;
		}

		.lang-icon {
			width: 0.9rem;
			height: 0.9rem;
		}
	}
</style>
